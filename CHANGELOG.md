## v0.4.0

* 登录查询商店
* 每日商店推送

## v.0.4.1

* 修复登录后若不主动查询商店,则开启定时任务后无法推送每日商店的问题.
* 修复在不设置地区的情况下,可开启定时任务的问题.
* 代码优化.
* 添加Valorant皮肤库数据刷新定时任务.

> other:
>> * 现在当输入的不正确时,机器人会返回未知操作,而不是返回帮助列表.

> todo:
>> * 定时任务手动触发
>> * 每日商店可自定推送背景图
>> * 每日商店推送任务可指定发送地点(私聊, 群聊)
>> * 执行逻辑时若等待时间超时(5分钟)自动取消,并发送回执给用户
>> * 增加权限管控(用于手动触发定时任务)
>
> **2023.07.06完成**

## v0.5.0-pre

**_重要: 请使用过旧版本的用户,将/config/io.tiangou.valorant-bot-plugin文件夹下所有文件都删除,
/data/io.tiangou.valorant-bot-plugin文件夹下除了user-cache.json文件以外的其他文件也请全部删除
本次更新对内部一些实现及API做了相当多相当大的调整,尤其是Sqlite数据库文件,对表结构进行了优化调整,
继续使用旧版的数据及配置文件可能会出现很大问题!!_**

* 增加插件内定时任务相关操作指令(Mirai Command指令)
* 优化商店查询的逻辑,现在同一天内的多次查询会取缓存数据,而不是每次都重新生成图片
* 增加了一个插件全局的配置文件(plugin-config.yml), 目前可以通过配置文件来自定义事件监听相关的处理逻辑
* 增加了操作执行中等待输出超时后取消操作的逻辑
* 增加了上次Valorant更新后,最新推出的**每周"配件商店"**查询功能
* 增加了每日商店及配件商店生成背景图自定义的功能
* 增加了一些定时任务,如缓存清空(后台任务),刷新账号安全认证等.
* 数据库及持久化相关实现优化

## v.0.5.0

* 相较于V0.5.0-pre没有功能性上的变化
* 优化了一些代码逻辑

## v.0.5.1

* 修复了一个用户切换账号后可能会出现的缓存泄漏问题

## v0.6.0

* 增加了插件监听群相关的配置,可以监听或者不监听指定的群/用户
* 现在已经将skiko的依赖项排除,若选用skiko进行绘图,才会下载相关依赖
* 增加了绘图API的配置,现在可以手动选用skiko或原生awt进行绘图
* 用户现在可以指定每日商店的推送地点,推送地点可以配置为多个
* 现在每日商店推送失败时,会将错误信息返回给用户
* 优化了一些代码逻辑

> other:
>> 本插件目前包含了几个自定义的Console指令 </br>
**-- /task 定时任务相关 </br>**
**-- /visit 访问权限(插件黑白名单群/用户)管控相关 </br>**
>> 若有使用需要 可到Console输入 /help 查看更多信息,在此不进行介绍

> todo:
>> * 目前awt和skiko的切换仅仅是可用状态,关于更多内部细节的抽象和引用依赖并未很好的优化,后续应该会进行不小的改动
>
>**2023.08.26 完成**

## v0.6.1

* 修复了在某些情况下用户无法登录的问题

## v0.6.2

* 修复了每日商店定时任务推送给用户私聊时无法发送的问题

## v0.7.0

* 逻辑责任链代码优化
* 用户缓存中的每日商店推送地点的原数据结构已弃用
* 删除了指令等待时间超时自动退出的逻辑,有需要请手动退出
* 现在可以自定义绘图使用的字体文件
* 优化了AWT SKIKO绘图逻辑
* 生成图片缓存结构优化 (缓存文件 or 内存, and 数据结构) ImageGenerator.cache()
* UserCache数据类的新老适配器 由于数据结构设计不佳导致经常变动(后续可能还会变动,且不会跨版本来进行数据兼容,请及时更新)
  需要写一个适配器来兼容旧版的UserCache

## v0.8.0

* 修复了UserCache数据类适配器的Bug
* 优化了提示菜单 当用户输入不正确时会提示近似的指令,例如指令有 "查询商店" "查询配件商店" 时,用户输入 "商店"
  后会提示输入的指令不正确并提示可用的指令有 "查询商店" "查询配件商店", 且仅当用户输入包含关键字时才会触发
* 优化代码
* 缓存结构优化 把ImageGenerator里的cache迁移到UserCache中 每个用户分别持有自己的独立缓存 而不是使用统一的缓存
* 将每日商店, 每周配件商店, 夜市的清理, 从定时任务 迁移到 延时任务中
* 长时间登录过期的用户会被自动清除登录信息 (7天清理Riot登录数据, 30天所有用户数据, 可配置)
* 每日商店推送订阅逻辑及推送任务逻辑调整
* 添加用户数据清理逻辑块 (可选清理全部用户数据 或 仅清理用户Riot账号登录信息)
* 添加每周配件商店推送任务

>other:
>> * 由于改动量比较大, 升级到v0.8.0后请删除config下原有的配置文件, 让插件重新生成一份配置文件.
>>   
>>   避免不必要的bug出现
>>
>>  ~~设计水平比较拙劣,主要总是看着自己的老设计不爽~~   
>> 
>> * 关于定时推送相关的任务, 有一个很重要的点, 一直都忘记说了.
>> 
>>   如果是直接推送给用户而不是在群里推送的话, 可能会出现不推送的情况. 
>> 
>>   这种情况一般是Bot找不到联系人导致的, 添加机器人为好友就好了.
>> 
>>   所以在之前会有一个校验逻辑是判断是否添加机器人为好友, 是好友的情况下才能继续.
>> 
>>   目前已经把这个逻辑去掉了, 所以在这个地方特别说明一下.
>> 
>>   如果有类似情况发生, 请务必确认下是否是这一点导致的问题.

> todo :
>> * 查询夜市 目前准备还是按照每日商店推送的格式(9:16生成, 只不过图片间隔应该会进行相对应的调整)
>> * 对局信息推送

## v0.8.1

* 修复了每周配件商店定时任务推送选用每日商店枚举类型筛选的bug

## v0.8.2

* 修复了SKIKO绘图API的绘制图像比例问题